<% if @merchant %>

  <%= link_to 'Products', merchant_products_path(@merchant) %>
  <p>
    <%= @merchant.username %>'s orders
  </p>

  <table>
    <tr>
      <th>
      </th>
      <th>
        Pending Orders
      </th>
      <th>
        Paid Orders
      </th>
      <th>
        Completed Orders
      </th>
      <th>
        Cancelled Orders
      </th>
      <th>
        All Orders
      </th>
    </tr>
    <tr>
      <th>
        Revenue
      </th>
      <td>
        <%= @merchant.total_revenue_by("pending") %>
      </td>
      <td>
        <%= @merchant.total_revenue_by("paid") %>
      </td>
      <td>
        <%= @merchant.total_revenue_by("completed") %>
      </td>
      <td>
        <%= @merchant.total_revenue_by("cancelled") %>
      </td>
      <td>
        <%= @merchant.total_revenue_by("all") %>
      </td>
    </tr>
    <tr>
      <th>
        No. Orders
      </th>
      <td>
        <%=  %>
      </td>
      <td>
        <%=  %>
      </td>
      <td>
        <%=  %>
      </td>
      <td>
        <%=  %>
      </td>
      <td>
        <%=  %>
      </td>
    </tr>
  </table>

  <% if @orders_and_items.empty? %>
    <p>
      <%= @merchant.username %> has no orders yet.
    </p>
  <% else %>

    <table>
      <tr>
        <th>
          Order
        </th>
        <th>
          Product
        </th>
        <th>
          Quantity
        </th>
        <th>
          Subtotal
        </th>
        <th>
          Placed On
        </th>
        <th>
          Mark as Shipped
        </th>
        <th>
          Status
        </th>
      </tr>


      <% @orders_and_items.each do |order, order_items| %>
        <tr>
          <td rowspan="<%= order_items.length %>" >
            <%= link_to order, order_path(order) %>
          </td>
        <% order_items.each do |order_item| %>
            <td>
              <%= link_to order_item.product.name, product_path(order_item.product) %>
            </td>
            <td>
              <%= order_item.quantity %>
            </td>
            <td>
              <%= order_item.subtotal %>
            </td>
            <td>
              <%= readable_date(order_item.order.updated_at) %>
            </td>
            <td>
              "ship"
            </td>
            <td>
              <%= order_item.order.status %>
            </td>
          </tr>
        <% end %>

      <% end %>

    </table>

    <% @orders_and_items.each do |order, order_items| %>

      <table>
        <tr>

        </tr>
      </table>

    <% end %>

  <% end %>
<% end %>
