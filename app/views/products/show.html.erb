<%= render partial: "review_form" %>

<h1>Item details</h1>

<section class = "row product-show container">
  <article class = "column small-12 medium-6 image-show">
    <%= image_tag ('https://placeimg.com/350/200/nature') %>
  </article>

  <article class = "column small-12 medium-6">
    <p><strong>Product:</strong> <%= @product.name %></p>
    <p><strong>Stock:</strong> <%= @product.quantity %></p>
    <p><strong>Price:</strong> <%= format_price(@product.price) %>
    <p>
      <strong>Description:</strong>
      <% if @product.description %>
      <%= @product.description %>
      <% else %>
      <%= "None" %>
      <% end %>
    </p>

    <section class='product-form'>
      <%= form_for (Orderproduct.new), :url => orderproducts_path do |f| %>
      <%= f.label :quantity %>
      <%= f.select :quantity, options_for_select(1..@product.quantity)%>
      <%= f.hidden_field :product_id, value: @product.id %>
      <%= f.submit "Add to cart", class: "button" %>
      <% end %>
    </section>

    <section class = "rating-average-container">
      <h4>Ratings Summary</h4>
      <p>
        <%="Average rating: #{@product.average_rating}" %>
      </p>
    </section>

    <section class = "rating-container">
      <h4>Rating</h4>
      <% if @product.reviews.empty? %>
      <p>
        Be the first to review!
      </p>
      <%else %>
      <ul>
        <% @product.reviews.each do |review| %>
        <article>
          <li>
            <%review.rating.times do %>
            <%= "🍦" %>
            <% end %>
          </li>
          <%= review.comment %>
        </article>
        <%end %>
      </ul>
      <% end %>

      <p>
        <%=link_to "review now!", new_product_review_path(@product.id), class: 'button' %>
      </p>
    </section>
  </article>
</section>
